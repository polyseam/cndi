blocks:
  argo_ingress: https://raw.githubusercontent.com/polyseam/cndi/main/src/templates/fragments/argo-ingress.yaml

prompts:
  # because the "kind" is used in every template, it currently lives before this chronologically
  - name: kind
    default: ec2
    message: 'Please enter the kind of node you want to use:'
    type: Select
    options:
      - ec2
      - eks
      - gcp
      - azure
      - dev

  - name: argocdDomainName
    default: argocd.example.com
    message: 'Please enter the domain name you want argocd to be accessible on:'
    type: Input
    validators:
      - named: hostname

  - message: 'Please enter the email address you want to use for lets encrypt:'
    default: admin@example.com
    name: letsEncryptClusterIssuerEmailAddress
    type: Input
    validators:
      - named: email

outputs:
  cndi-config:
    cndi_version: v1
    infrastructure:
      cndi:
        cert_manager:
          email: '{{ $.cndi.prompts.responses.letsEncryptClusterIssuerEmailAddress }}'
        nodes:
          - name: x-node
            kind: '{{ $.cndi.prompts.responses.kind }}'
            role: leader
            volume_size: 128
          - name: y-node
            kind: '{{ $.cndi.prompts.responses.kind }}'
            volume_size: 128
          - name: z-node
            kind: '{{ $.cndi.prompts.responses.kind }}'
            volume_size: 128
    cluster_manifests:
      argo-ingress:
        _block_by_name:
          name: argo_ingress
    applications: {}
  env:
    extend_basic_env: '{{ $.cndi.prompts.responses.kind }}'
  readme:
    extend_basic_readme: '{{ $.cndi.prompts.responses.kind }}'