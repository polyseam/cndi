prompts:
  - $cndi.get_block(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/common/clusterless/core-prompts.yaml):
      {}
  - $cndi.get_block(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/{{ $cndi.get_prompt_response(deployment_target_provider) }}/core-prompts.yaml):
      {}
  - name: my_rds_password
    type: Secret
    message: "Enter the password for the RDS instance"
    default: "password"

outputs:
  cndi_config:
    # source_control_platform: github ?
    cndi_version: v2
    project_name: "{{ $cndi.get_prompt_response(project_name) }}"
    provider: "{{ $cndi.get_prompt_response(deployment_target_provider) }}"
    distribution: "clusterless"
    # this is a Template comment
    infrastructure:
      terraform:
        variable:
          rds_password:
            sensitive: true
            description: "The password for the RDS instance"

  env:
    $cndi.get_block(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/common/git-credentials-{{ $cndi.get_prompt_response(git_credentials_mode) }}-env.yaml):
      {}

    $cndi.get_block(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/{{ $cndi.get_prompt_response(deployment_target_provider) }}/env.yaml):
      {}

    $cndi.get_block(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/common/clusterless/env.yaml):
      {}
    TF_VAR_rds_password: "{{ $cndi.get_prompt_response(my_rds_password) }}"

  readme:
    project_name: "# {{ $cndi.get_prompt_response(project_name) }}"
    $cndi.get_string(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/common/clusterless/core-readme.md):
      {}
    $cndi.get_string(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/{{ $cndi.get_prompt_response(deployment_target_provider) }}/core.md):
      {}
    $cndi.get_string(https://raw.githubusercontent.com/polyseam/cndi/main/blocks/{{ $cndi.get_prompt_response(deployment_target_provider) }}/{{ $cndi.get_prompt_response(deployment_target_distribution) }}.md):
      {}

    basic: |
      # Basic Clusterless Deployment Guide

      This Template provides the essential building blocks of a CNDI Cluster,
      and can be extended to meet any need. If there is no existing 
      CNDI Template for your use-case, we recommend deploying this `basic`
      Template as is. 

      After you verify the Template is deployed successfully to your 
      infrastructure, it can be enhanced using the `cndi_config.yaml` fields 
      `applications` and `cluster_manifests` with Kubernetes manifests 
      and Helm charts respectively.
